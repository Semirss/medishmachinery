<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard | Industrial Machinery Rent</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script>
  // Tailwind config matching home page
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: {
          'heading': ['Exo 2', 'sans-serif'],
          'body': ['Inter', 'sans-serif'],
        },
        colors: {
          'industrial': {
            'yellow': '#FFB347',
            'orange': '#FF8C00',
            'gray': '#1A202C',
            'dark-gray': '#0F1419',
            'blue': '#2B6CB0',
            'safety': '#FF6B35',
            'green': '#38A169',
            'light-gray': '#EDF2F7',
            'steel': '#4A5568',
            'border': '#CBD5E0'
          }
        },
        boxShadow: {
          'card': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
          'heavy': '0 10px 25px -5px rgba(0, 0, 0, 0.15)',
          'glow': '0 0 20px rgba(255, 179, 71, 0.3)'
        },
        animation: {
          'fade-in': 'fadeIn 0.5s ease-in-out',
          'slide-up': 'slideUp 0.3s ease-out'
        },
        keyframes: {
          fadeIn: {
            '0%': { opacity: '0' },
            '100%': { opacity: '1' }
          },
          slideUp: {
            '0%': { transform: 'translateY(10px)', opacity: '0' },
            '100%': { transform: 'translateY(0)', opacity: '1' }
          }
        }
      }
    }
  }
</script>
<style>
  /* Custom scrollbar matching home page */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  ::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  ::-webkit-scrollbar-thumb {
    background: #FFB347;
    border-radius: 4px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: #FF8C00;
  }
  
  /* Status badge styling */
  .status-badge {
    @apply px-3 py-1 text-xs font-semibold rounded-full border transition-all duration-200;
  }
  
  /* Loading animation */
  .loading-spinner {
    border: 3px solid #f3f3f3;
    border-top: 3px solid #FFB347;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>

<body class="bg-industrial-light-gray font-body text-industrial-gray">

<!-- Login Screen -->
<div id="loginScreen" class="fixed inset-0 bg-industrial-dark-gray flex flex-col justify-center items-center p-4 z-50">
    <div class="bg-white p-8 sm:p-12 rounded-xl shadow-heavy w-full max-w-md border border-industrial-border animate-fade-in">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-heading font-black text-industrial-gray mb-2">
                <span class="text-industrial-yellow">INDUSTRIAL</span> ADMIN
            </h1>
            <p class="text-industrial-steel">Machinery Rental Management System</p>
        </div>
        
        <h2 class="text-2xl font-heading font-bold text-center mb-6 text-industrial-gray">Admin Login</h2>
        <p class="text-sm text-center text-gray-500 mb-8">
            <i class="fas fa-shield-alt text-industrial-yellow mr-2"></i>
            Secure Administrator Access
        </p>
        
        <form id="loginForm" onsubmit="login(event)" class="space-y-6">
            <div>
                <label for="username" class="block text-sm font-medium mb-2 flex items-center">
                    <i class="fas fa-user text-industrial-blue mr-2"></i>
                    Username
                </label>
                <input type="text" id="username" required 
                    class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all shadow-sm"
                    placeholder="Enter admin username">
            </div>

            <div>
                <label for="password" class="block text-sm font-medium mb-2 flex items-center">
                    <i class="fas fa-lock text-industrial-blue mr-2"></i>
                    Password
                </label>
                <input type="password" id="password" required 
                    class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all shadow-sm"
                    placeholder="Enter password">
            </div>
            
            <div id="loginError" class="hidden bg-red-50 border border-red-200 text-red-700 p-3 rounded-lg flex items-center">
                <i class="fas fa-exclamation-circle mr-2"></i>
                <span>Invalid username or password. Please try again.</span>
            </div>

            <button type="submit" 
                class="w-full bg-industrial-yellow text-industrial-gray font-bold py-3 rounded-lg hover:bg-industrial-orange transition-all duration-300 shadow-md hover:shadow-lg flex items-center justify-center group">
                <i class="fas fa-sign-in-alt mr-2 transition-transform group-hover:translate-x-1"></i>
                Log In to Dashboard
            </button>
        </form>
        
        <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
            <div class="flex items-start">
                <i class="fas fa-exclamation-triangle text-yellow-500 mt-0.5 mr-2"></i>
                <div>
                    <p class="text-xs font-medium text-yellow-800">DEMONSTRATION ONLY</p>
                    <p class="text-xs text-yellow-700 mt-1">
                        <strong>Credentials:</strong> admin / pass123<br>
                        ⚠️ This is a client-side demo. Production systems require server-side authentication, HTTPS, password hashing, and proper security measures.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Admin Content -->
<div id="adminContent" class="hidden min-h-screen">
    <!-- Header/Navigation -->
    <nav class="bg-industrial-gray text-white px-6 py-4 flex justify-between items-center shadow-heavy border-b border-industrial-yellow/30">
      <div class="flex items-center space-x-4">
        <div class="bg-industrial-yellow p-2 rounded-lg">
          <i class="fas fa-cogs text-industrial-gray text-xl"></i>
        </div>
        <div>
          <h1 class="font-heading font-bold text-xl">Admin Dashboard</h1>
          <p class="text-xs text-gray-300">Industrial Machinery Rental System</p>
        </div>
      </div>
      <div class="space-x-4 flex items-center">
        <div class="hidden md:flex items-center space-x-2 text-sm bg-industrial-steel/30 px-3 py-1 rounded-lg">
          <i class="fas fa-user-shield"></i>
          <span>Administrator</span>
        </div>
        <button onclick="logout()" class="text-sm px-4 py-2 bg-industrial-safety rounded-lg hover:bg-red-700 transition-all flex items-center shadow-md">
          <i class="fas fa-sign-out-alt mr-2"></i>
          Log Out
        </button>
        <a href="index.html" class="text-sm px-4 py-2 bg-industrial-blue rounded-lg hover:bg-blue-700 transition-all flex items-center shadow-md">
          <i class="fas fa-home mr-2"></i>
          View Site
        </a>
      </div>
    </nav>
    
    <!-- Main Content Area -->
    <main class="p-6">
      <!-- Tab Navigation -->
      <div class="flex border-b border-industrial-border mb-8 bg-white rounded-t-lg overflow-hidden shadow-card">
        <button onclick="showTab('dashboard')" id="tab-dashboard" class="py-4 px-8 font-medium border-b-2 border-industrial-yellow bg-white text-industrial-gray transition-all flex items-center">
          <i class="fas fa-tachometer-alt mr-2"></i>
          Dashboard
        </button>
        <button onclick="showTab('inventory')" id="tab-inventory" class="py-4 px-8 font-medium border-b-2 border-transparent hover:border-industrial-yellow transition-all flex items-center">
          <i class="fas fa-hard-hat mr-2"></i>
          Machine Inventory
        </button>
        <button onclick="showTab('orders')" id="tab-orders" class="py-4 px-8 font-medium border-b-2 border-transparent hover:border-industrial-yellow transition-all flex items-center">
          <i class="fas fa-clipboard-list mr-2"></i>
          Order Management
        </button>
      </div>

      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content">
        <div class="flex justify-between items-center mb-8">
          <div>
            <h2 class="text-3xl font-heading font-bold">System Overview</h2>
            <p class="text-industrial-steel">Key metrics at a glance</p>
          </div>
          <button onclick="refreshAllData()" class="px-4 py-2 bg-industrial-blue text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center">
            <i class="fas fa-sync-alt mr-2"></i>
            Refresh
          </button>
        </div>

        <!-- Dashboard Stats -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div class="bg-white p-6 rounded-xl shadow-card border-l-4 border-industrial-yellow animate-slide-up">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-sm text-gray-500 uppercase tracking-wider font-medium">Total Machines</p>
                <p id="dashboard-total-machines" class="text-3xl font-heading font-bold mt-1">0</p>
              </div>
              <div class="bg-industrial-yellow/20 p-3 rounded-lg">
                <i class="fas fa-hard-hat text-industrial-yellow text-xl"></i>
              </div>
            </div>
            <div class="mt-4 text-sm">
              <span id="available-machines" class="text-industrial-green font-medium">0 available</span>
              <span class="mx-2">•</span>
              <span id="rented-machines" class="text-industrial-yellow font-medium">0 rented</span>
            </div>
          </div>
          
          <div class="bg-white p-6 rounded-xl shadow-card border-l-4 border-industrial-blue animate-slide-up" style="animation-delay: 0.1s">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-sm text-gray-500 uppercase tracking-wider font-medium">Pending Orders</p>
                <p id="dashboard-pending-orders" class="text-3xl font-heading font-bold mt-1">0</p>
              </div>
              <div class="bg-industrial-blue/20 p-3 rounded-lg">
                <i class="fas fa-clock text-industrial-blue text-xl"></i>
              </div>
            </div>
            <p class="text-sm text-industrial-steel mt-4">Awaiting processing</p>
          </div>
          
          <div class="bg-white p-6 rounded-xl shadow-card border-l-4 border-industrial-safety animate-slide-up" style="animation-delay: 0.2s">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-sm text-gray-500 uppercase tracking-wider font-medium">Unverified Payments</p>
                <p id="dashboard-unverified-payments" class="text-3xl font-heading font-bold mt-1">0</p>
              </div>
              <div class="bg-industrial-safety/20 p-3 rounded-lg">
                <i class="fas fa-exclamation-triangle text-industrial-safety text-xl"></i>
              </div>
            </div>
            <p class="text-sm text-industrial-safety mt-4">Requires attention</p>
          </div>
        </div>
      </div>

      <!-- Inventory Tab -->
      <div id="inventory" class="tab-content hidden">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
          <div>
            <h2 class="text-3xl font-heading font-bold">Machine Inventory</h2>
            <p class="text-industrial-steel">Manage all machinery in the rental fleet</p>
          </div>
          <div class="flex flex-wrap items-center gap-4 mt-4 md:mt-0">
            <div class="relative">
              <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="text" id="inventorySearch" placeholder="Search machines..." 
                class="pl-10 pr-4 py-2 border border-industrial-border rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow w-64"
                onkeyup="filterInventoryGrid()">
            </div>
            <select id="inventoryFilter" onchange="filterInventoryGrid()" class="border border-industrial-border rounded-lg p-2 focus:ring-2 focus:ring-industrial-yellow">
              <option value="all">All Categories</option>
              <option value="Earthmoving">Earthmoving</option>
              <option value="Road Construction">Road Construction</option>
              <option value="Material Handling">Material Handling</option>
              <option value="Concrete">Concrete</option>
              <option value="Other">Other</option>
            </select>
            <button onclick="openMachineForm()" class="bg-industrial-yellow text-industrial-gray font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-industrial-orange transition-all flex items-center">
              <i class="fas fa-plus mr-2"></i>
              Add New Machine
            </button>
          </div>
        </div>

        <!-- Inventory Grid -->
        <div id="inventoryGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Will be populated by JavaScript -->
          <div id="inventoryLoading" class="col-span-full text-center py-12">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-gray-500">Loading inventory data...</p>
          </div>
        </div>
        
        <!-- Empty State -->
        <div id="inventoryEmpty" class="hidden text-center py-12">
          <i class="fas fa-hard-hat text-gray-300 text-4xl mb-4"></i>
          <h3 class="text-xl font-heading font-bold text-gray-500">No machines found</h3>
          <p class="text-gray-400 mt-2">Add your first machine to get started</p>
          <button onclick="openMachineForm()" class="mt-4 bg-industrial-yellow text-industrial-gray font-semibold py-2 px-4 rounded-lg hover:bg-industrial-orange transition-colors">
            Add New Machine
          </button>
        </div>
      </div>

      <!-- Orders Tab -->
      <div id="orders" class="tab-content hidden">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
          <div>
            <h2 class="text-3xl font-heading font-bold">Order Management</h2>
            <p class="text-industrial-steel">Manage customer orders and payments</p>
          </div>
          <div class="flex flex-wrap items-center gap-4 mt-4 md:mt-0">
            <div class="relative">
              <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="text" id="orderSearch" placeholder="Search orders..." 
                class="pl-10 pr-4 py-2 border border-industrial-border rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow w-64"
                onkeyup="filterOrderTable()">
            </div>
            <select id="orderStatusFilter" onchange="filterOrderTable()" class="border border-industrial-border rounded-lg p-2 focus:ring-2 focus:ring-industrial-yellow">
              <option value="all">All Status</option>
              <option value="Pending">Pending</option>
              <option value="Processing">Processing</option>
              <option value="Completed">Completed</option>
              <option value="Cancelled">Cancelled</option>
            </select>
          </div>
        </div>

        <!-- Orders Table -->
        <div class="bg-white rounded-xl shadow-card overflow-hidden">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-industrial-border">
              <thead class="bg-industrial-gray text-white">
                <tr class="text-left text-sm font-heading font-semibold uppercase tracking-wider">
                  <th class="p-4">Order ID</th>
                  <th class="p-4">Date</th>
                  <th class="p-4">Total</th>
                  <th class="p-4">Payment</th>
                  <th class="p-4">Status</th>
                  <th class="p-4">Customer</th>
                  <th class="p-4 text-center">Actions</th>
                </tr>
              </thead>
              <tbody id="orderList" class="bg-white divide-y divide-industrial-border">
                <!-- Will be populated by JavaScript -->
              </tbody>
            </table>
          </div>
          
          <!-- Empty State -->
          <div id="ordersEmpty" class="hidden p-8 text-center">
            <i class="fas fa-clipboard-list text-gray-300 text-4xl mb-4"></i>
            <h3 class="text-xl font-heading font-bold text-gray-500">No orders found</h3>
            <p class="text-gray-400 mt-2">Orders will appear here when customers make rentals</p>
          </div>
          
          <!-- Loading State -->
          <div id="ordersLoading" class="p-8 text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-gray-500">Loading orders data...</p>
          </div>
        </div>
      </div>
    </main>

    <!-- Machine Form Modal -->
    <div id="machineFormModal" class="hidden fixed inset-0 bg-black/70 flex justify-center items-center p-4 z-50">
      <div class="bg-white max-w-2xl w-full p-8 rounded-2xl relative max-h-[90vh] overflow-y-auto shadow-heavy animate-slide-up">
        <button onclick="closeMachineForm()" class="absolute top-4 right-4 text-industrial-gray hover:text-industrial-orange text-xl transition-colors">
          <i class="fas fa-times"></i>
        </button>
        <h3 id="machineFormTitle" class="text-2xl font-heading font-bold mb-2">Add New Machine</h3>
        <p class="text-industrial-steel mb-6">Fill in the details for the new machinery</p>
        
        <form id="machineForm" onsubmit="saveMachine(event)" class="space-y-6">
          <input type="hidden" id="machineId">
          
          <!-- Validation Error Container -->
          <div id="formErrors" class="hidden bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg">
            <p class="font-medium"><i class="fas fa-exclamation-circle mr-2"></i>Please fix the following errors:</p>
            <ul id="errorList" class="mt-2 ml-6 list-disc text-sm"></ul>
          </div>
          
          <!-- Form Fields Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block mb-2 font-medium text-industrial-gray">
                <i class="fas fa-tag text-industrial-blue mr-2"></i>
                Machine Name *
              </label>
              <input type="text" id="m-name" required 
                class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all"
                placeholder="e.g., Excavator XYZ-500">
              <p class="text-xs text-gray-500 mt-1">Enter the full machine model name</p>
            </div>
            
            <div>
              <label class="block mb-2 font-medium text-industrial-gray">
                <i class="fas fa-folder text-industrial-blue mr-2"></i>
                Category *
              </label>
              <select id="m-category" required 
                class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all">
                <option value="">Select Category</option>
                <option value="Earthmoving">Earthmoving</option>
                <option value="Road Construction">Road Construction</option>
                <option value="Material Handling">Material Handling</option>
                <option value="Concrete">Concrete</option>
                <option value="Other">Other</option>
              </select>
            </div>
            
            <div>
              <label class="block mb-2 font-medium text-industrial-gray">
                <i class="fas fa-dollar-sign text-industrial-blue mr-2"></i>
                Price/Day ($) *
              </label>
              <input type="number" id="m-price" required min="1" step="0.01"
                class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all"
                placeholder="e.g., 250.00">
              <p class="text-xs text-gray-500 mt-1">Minimum $1 per day</p>
            </div>
            
            <div>
              <label class="block mb-2 font-medium text-industrial-gray">
                <i class="fas fa-info-circle text-industrial-blue mr-2"></i>
                Status *
              </label>
              <select id="m-status" required
                class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all">
                <option value="Available">Available</option>
                <option value="Rented">Rented</option>
                <option value="Maintenance">Maintenance</option>
              </select>
            </div>
            
            <div class="md:col-span-2">
              <label class="block mb-2 font-medium text-industrial-gray">
                <i class="fas fa-image text-industrial-blue mr-2"></i>
                Image URL *
              </label>
              <input type="url" id="m-image" required
                class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all"
                placeholder="https://example.com/machine-image.jpg">
              <p class="text-xs text-gray-500 mt-1">Enter a direct link to a high-quality image</p>
            </div>
            
            <div class="md:col-span-2">
              <label class="block mb-2 font-medium text-industrial-gray">
                <i class="fas fa-exclamation-triangle text-industrial-safety mr-2"></i>
                Safety Notes
              </label>
              <textarea id="m-safetyNotes" rows="3"
                class="w-full border border-industrial-border p-3 rounded-lg focus:ring-2 focus:ring-industrial-yellow focus:border-industrial-yellow transition-all"
                placeholder="Important safety precautions and operational guidelines..."></textarea>
              <p class="text-xs text-gray-500 mt-1">Optional safety information for operators</p>
            </div>
          </div>
          
          <!-- Image Preview -->
          <div id="imagePreviewContainer" class="hidden">
            <p class="font-medium mb-2">Image Preview:</p>
            <div class="border border-industrial-border rounded-lg p-4 bg-gray-50">
              <img id="imagePreview" src="" alt="Preview" class="max-h-40 mx-auto rounded">
            </div>
          </div>
          
          <!-- Form Actions -->
          <div class="flex justify-end space-x-4 pt-6 border-t border-industrial-border">
            <button type="button" onclick="closeMachineForm()" class="px-6 py-3 border border-industrial-border rounded-lg hover:bg-gray-50 transition-colors">
              Cancel
            </button>
            <button type="submit" id="saveMachineButton" class="px-6 py-3 bg-industrial-yellow text-industrial-gray font-bold rounded-lg hover:bg-industrial-orange transition-colors shadow-md hover:shadow-lg flex items-center">
              <i class="fas fa-save mr-2"></i>
              Save Machine
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="hidden fixed inset-0 bg-black/70 flex justify-center items-center p-4 z-50">
      <div class="bg-white max-w-3xl w-full p-8 rounded-2xl relative max-h-[90vh] overflow-y-auto shadow-heavy animate-slide-up">
        <button onclick="closeOrderDetails()" class="absolute top-4 right-4 text-industrial-gray hover:text-industrial-orange text-xl transition-colors">
          <i class="fas fa-times"></i>
        </button>
        <h3 class="text-2xl font-heading font-bold mb-2">Order Details</h3>
        <p class="text-industrial-steel mb-6">Order ID: <span id="orderDetailId" class="font-bold"></span></p>
        <div id="orderDetailContent" class="space-y-6"></div>
      </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="hidden fixed bottom-6 right-6 bg-industrial-gray text-white p-4 rounded-lg shadow-heavy z-50 max-w-sm animate-slide-up">
      <div class="flex items-start">
        <i id="toastIcon" class="fas fa-check-circle text-industrial-green mt-0.5 mr-3 text-xl"></i>
        <div>
          <p id="toastTitle" class="font-bold"></p>
          <p id="toastMessage" class="text-sm text-gray-300 mt-1"></p>
        </div>
        <button onclick="hideToast()" class="ml-4 text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
</div>

<script>
// ========== GLOBAL CONSTANTS & INITIALIZATION ==========
const VALID_USERNAME = 'admin';
const VALID_PASSWORD = 'pass123';
const STORAGE_KEY_LOGGED_IN = 'adminLoggedIn';

// Initialize sample data
function initializeOrders() {
    if (!localStorage.getItem("orders")) {
        const machines = JSON.parse(localStorage.getItem("machines")) || [];
        const excavator = machines.find(m => m.id === 1) || {id: 1, name: "Excavator", price: 250, category: "Earthmoving"};
        const compactor = machines.find(m => m.id === 4) || {id: 4, name: "Compactor", price: 195, category: "Road Construction"};
        const forklift = machines.find(m => m.id === 2) || {id: 2, name: "Forklift", price: 120, category: "Material Handling"};
        
        localStorage.setItem("orders", JSON.stringify([
            {
                orderId: 1001,
                datePlaced: "2025-12-14",
                customer: "Construction Co Inc.",
                customerEmail: "contact@constructionco.com",
                items: [
                    { machineId: excavator.id, name: excavator.name, quantity: 1, days: 5, pricePerDay: excavator.price, total: 1250, startDate: "2025-12-20", endDate: "2025-12-25" },
                ],
                totalAmount: 1250,
                status: "Pending",
                paymentStatus: "Unverified"
            },
            {
                orderId: 1002,
                datePlaced: "2025-12-15",
                customer: "BuildRight Contractors",
                customerEmail: "info@buildright.com",
                items: [
                    { machineId: compactor.id, name: compactor.name, quantity: 2, days: 10, pricePerDay: compactor.price, total: 3900, startDate: "2026-01-05", endDate: "2026-01-15" },
                ],
                totalAmount: 3900,
                status: "Processing",
                paymentStatus: "Verified"
            },
            {
                orderId: 1003,
                datePlaced: "2025-12-10",
                customer: "Warehouse Solutions",
                customerEmail: "rentals@warehousesolutions.com",
                items: [
                    { machineId: forklift.id, name: forklift.name, quantity: 3, days: 7, pricePerDay: forklift.price, total: 2520, startDate: "2025-12-18", endDate: "2025-12-25" },
                ],
                totalAmount: 2520,
                status: "Completed",
                paymentStatus: "Verified"
            }
        ]));
    }
}

// Helper functions
const getMachines = () => JSON.parse(localStorage.getItem("machines")) || [];
const getOrders = () => JSON.parse(localStorage.getItem("orders")) || [];
const setMachines = (machines) => localStorage.setItem("machines", JSON.stringify(machines));
const setOrders = (orders) => localStorage.setItem("orders", JSON.stringify(orders));

// Status color mapping
function getStatusColor(status) {
    switch (status) {
        case 'Available':
        case 'Verified':
        case 'Completed':
            return 'industrial-green';
        case 'Rented':
        case 'Pending':
        case 'Unverified':
            return 'industrial-yellow';
        case 'Maintenance':
        case 'Cancelled':
            return 'industrial-safety';
        case 'Processing':
            return 'industrial-blue';
        default:
            return 'industrial-gray';
    }
}

// ========== AUTHENTICATION ==========
function login(event) {
    event.preventDefault();
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    const errorEl = document.getElementById('loginError');
    const button = event.target.querySelector('button[type="submit"]');
    const originalText = button.innerHTML;
    
    // Show loading state
    button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Authenticating...';
    button.disabled = true;
    
    // Simulate network delay
    setTimeout(() => {
        if (username === VALID_USERNAME && password === VALID_PASSWORD) {
            localStorage.setItem(STORAGE_KEY_LOGGED_IN, 'true');
            errorEl.classList.add('hidden');
            showAdminContent();
            showNotification('Login Successful', 'Welcome to the Admin Dashboard', 'success');
        } else {
            errorEl.classList.remove('hidden');
            button.innerHTML = originalText;
            button.disabled = false;
        }
    }, 800);
}

function logout() {
    localStorage.removeItem(STORAGE_KEY_LOGGED_IN);
    hideAdminContent();
    showNotification('Logged Out', 'You have been successfully logged out', 'info');
}

function checkAuthentication() {
    const isLoggedIn = localStorage.getItem(STORAGE_KEY_LOGGED_IN) === 'true';
    if (isLoggedIn) {
        showAdminContent();
    } else {
        hideAdminContent();
    }
}

function showAdminContent() {
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('adminContent').classList.remove('hidden');
    showTab('dashboard');
}

function hideAdminContent() {
    document.getElementById('loginScreen').classList.remove('hidden');
    document.getElementById('adminContent').classList.add('hidden');
}

// ========== NOTIFICATION SYSTEM ==========
function showNotification(title, message, type = 'success') {
    const toast = document.getElementById('notificationToast');
    const icon = document.getElementById('toastIcon');
    const toastTitle = document.getElementById('toastTitle');
    const toastMessage = document.getElementById('toastMessage');
    
    // Set icon based on type
    const icons = {
        success: 'fa-check-circle',
        error: 'fa-exclamation-circle',
        warning: 'fa-exclamation-triangle',
        info: 'fa-info-circle'
    };
    
    const colors = {
        success: 'industrial-green',
        error: 'industrial-safety',
        warning: 'industrial-yellow',
        info: 'industrial-blue'
    };
    
    icon.className = `fas ${icons[type]} text-${colors[type]} mt-0.5 mr-3 text-xl`;
    toastTitle.textContent = title;
    toastMessage.textContent = message;
    
    toast.classList.remove('hidden');
    
    // Auto-hide after 5 seconds
    setTimeout(() => {
        if (!toast.classList.contains('hidden')) {
            hideToast();
        }
    }, 5000);
}

function hideToast() {
    document.getElementById('notificationToast').classList.add('hidden');
}

// ========== TAB MANAGEMENT ==========
let currentTab = 'dashboard';

function showTab(tabName) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
    
    // Deactivate all tab buttons
    document.querySelectorAll('[id^="tab-"]').forEach(btn => {
        btn.classList.remove('border-industrial-yellow', 'bg-white', 'text-industrial-gray');
        btn.classList.add('border-transparent');
    });

    // Show the selected tab content
    document.getElementById(tabName).classList.remove('hidden');
    
    // Activate the selected tab button
    const activeBtn = document.getElementById(`tab-${tabName}`);
    activeBtn.classList.add('border-industrial-yellow', 'bg-white', 'text-industrial-gray');
    activeBtn.classList.remove('border-transparent');
    
    currentTab = tabName;

    // Refresh content for the active tab
    if (tabName === 'inventory') {
        renderInventory();
    } else if (tabName === 'orders') {
        renderOrders();
    } else if (tabName === 'dashboard') {
        renderDashboard();
    }
}

// ========== DASHBOARD FUNCTIONS ==========
function renderDashboard() {
    const machines = getMachines();
    const orders = getOrders();
    
    // Calculate stats
    const totalMachines = machines.length;
    const availableMachines = machines.filter(m => m.status === 'Available').length;
    const rentedMachines = machines.filter(m => m.status === 'Rented').length;
    const pendingOrders = orders.filter(o => o.status === 'Pending').length;
    const unverifiedPayments = orders.filter(o => o.paymentStatus === 'Unverified').length;
    
    // Update dashboard elements
    document.getElementById('dashboard-total-machines').textContent = totalMachines;
    document.getElementById('available-machines').textContent = `${availableMachines} available`;
    document.getElementById('rented-machines').textContent = `${rentedMachines} rented`;
    document.getElementById('dashboard-pending-orders').textContent = pendingOrders;
    document.getElementById('dashboard-unverified-payments').textContent = unverifiedPayments;
}

function refreshAllData() {
    showNotification('Refreshing Data', 'Updating dashboard with latest information...', 'info');
    renderDashboard();
    if (currentTab === 'inventory') renderInventory();
    if (currentTab === 'orders') renderOrders();
    
    // Show success message after a short delay
    setTimeout(() => {
        showNotification('Data Refreshed', 'All data has been updated successfully', 'success');
    }, 800);
}

// ========== INVENTORY MANAGEMENT (GRID VIEW) ==========
function renderInventory() {
    const machines = getMachines();
    const grid = document.getElementById('inventoryGrid');
    const loading = document.getElementById('inventoryLoading');
    const empty = document.getElementById('inventoryEmpty');
    
    // Show loading
    grid.innerHTML = '';
    loading.classList.remove('hidden');
    empty.classList.add('hidden');
    
    // Simulate loading delay for better UX
    setTimeout(() => {
        // Check if empty
        if (machines.length === 0) {
            loading.classList.add('hidden');
            empty.classList.remove('hidden');
            return;
        }
        
        // Render grid
        grid.innerHTML = machines.map(m => {
            const statusColor = getStatusColor(m.status);
            
            return `
                <div class="bg-white rounded-xl shadow-card overflow-hidden border border-industrial-border hover:shadow-lg transition-all duration-300">
                    <div class="relative">
                        <img src="${m.image}" alt="${m.name}" class="w-full h-48 object-cover">
                        <div class="absolute top-3 right-3">
                            <span class="status-badge bg-${statusColor}-100 text-${statusColor} border-${statusColor}">
                                ${m.status}
                            </span>
                        </div>
                    </div>
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-heading font-bold text-lg truncate">${m.name}</h3>
                            <span class="font-bold text-industrial-yellow">$${m.price}/day</span>
                        </div>
                        
                        <div class="mb-4">
                            <span class="px-3 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">
                                ${m.category}
                            </span>
                        </div>
                        
                        ${m.safetyNotes ? `
                        <div class="mb-4 text-sm text-gray-600 bg-yellow-50 p-3 rounded-lg">
                            <i class="fas fa-exclamation-triangle text-yellow-500 mr-1"></i>
                            <span class="font-medium">Safety:</span> ${m.safetyNotes.substring(0, 60)}${m.safetyNotes.length > 60 ? '...' : ''}
                        </div>
                        ` : ''}
                        
                        <div class="flex justify-between pt-4 border-t border-industrial-border">
                            <span class="text-xs text-gray-500">
                                ID: ${m.id}
                            </span>
                            <div class="space-x-2">
                                <button onclick="editMachine(${m.id})" 
                                    class="px-3 py-1 text-sm bg-industrial-blue text-white rounded hover:bg-blue-700 transition-colors flex items-center">
                                    <i class="fas fa-edit mr-1"></i> Edit
                                </button>
                                <button onclick="deleteMachine(${m.id})" 
                                    class="px-3 py-1 text-sm bg-industrial-safety text-white rounded hover:bg-red-700 transition-colors flex items-center">
                                    <i class="fas fa-trash mr-1"></i> Delete
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }).join('');
        
        loading.classList.add('hidden');
        
        // Apply any active filters
        filterInventoryGrid();
    }, 300);
}

function filterInventoryGrid() {
    const searchTerm = document.getElementById('inventorySearch').value.toLowerCase();
    const categoryFilter = document.getElementById('inventoryFilter').value;
    const cards = document.querySelectorAll('#inventoryGrid > div.bg-white');
    
    let visibleCount = 0;
    
    cards.forEach(card => {
        const name = card.querySelector('h3').textContent.toLowerCase();
        const category = card.querySelector('.bg-gray-100').textContent;
        const matchesSearch = name.includes(searchTerm);
        const matchesCategory = categoryFilter === 'all' || category.includes(categoryFilter);
        
        if (matchesSearch && matchesCategory) {
            card.style.display = '';
            visibleCount++;
        } else {
            card.style.display = 'none';
        }
    });
    
    // Show/hide empty state
    const empty = document.getElementById('inventoryEmpty');
    const loading = document.getElementById('inventoryLoading');
    if (visibleCount === 0 && cards.length > 0) {
        empty.classList.remove('hidden');
        empty.innerHTML = `
            <i class="fas fa-search text-gray-300 text-4xl mb-4"></i>
            <h3 class="text-xl font-heading font-bold text-gray-500">No matching machines</h3>
            <p class="text-gray-400 mt-2">Try adjusting your search or filter</p>
        `;
    } else {
        empty.classList.add('hidden');
    }
}

// ========== MACHINE FORM (CRUD) ==========
function openMachineForm(id) {
    const modal = document.getElementById('machineFormModal');
    const form = document.getElementById('machineForm');
    
    // Reset form
    form.reset();
    document.getElementById('formErrors').classList.add('hidden');
    document.getElementById('imagePreviewContainer').classList.add('hidden');
    document.getElementById('machineId').value = '';
    document.getElementById('machineFormTitle').textContent = 'Add New Machine';
    
    // Preview image on URL change
    document.getElementById('m-image').addEventListener('input', function() {
        const previewContainer = document.getElementById('imagePreviewContainer');
        const previewImg = document.getElementById('imagePreview');
        
        if (this.value && this.value.startsWith('http')) {
            previewImg.src = this.value;
            previewContainer.classList.remove('hidden');
        } else {
            previewContainer.classList.add('hidden');
        }
    });
    
    // If editing, populate form
    if (id) {
        const machine = getMachines().find(m => m.id === id);
        if (machine) {
            document.getElementById('machineFormTitle').textContent = 'Edit Machine: ' + machine.name;
            document.getElementById('machineId').value = machine.id;
            document.getElementById('m-name').value = machine.name;
            document.getElementById('m-category').value = machine.category;
            document.getElementById('m-price').value = machine.price;
            document.getElementById('m-status').value = machine.status;
            document.getElementById('m-image').value = machine.image;
            document.getElementById('m-safetyNotes').value = machine.safetyNotes || '';
            
            // Trigger image preview
            if (machine.image) {
                document.getElementById('imagePreview').src = machine.image;
                document.getElementById('imagePreviewContainer').classList.remove('hidden');
            }
        }
    }
    
    modal.classList.remove('hidden');
}

function closeMachineForm() {
    document.getElementById('machineFormModal').classList.add('hidden');
}

function validateMachineForm() {
    const errors = [];
    const name = document.getElementById('m-name').value.trim();
    const price = parseFloat(document.getElementById('m-price').value);
    const image = document.getElementById('m-image').value.trim();
    
    // Name validation
    if (name.length < 2) {
        errors.push('Machine name must be at least 2 characters long');
    }
    
    // Price validation
    if (isNaN(price) || price < 1) {
        errors.push('Price must be at least $1 per day');
    }
    
    // Image URL validation (basic)
    if (image && !image.startsWith('http')) {
        errors.push('Image URL must be a valid web address (starting with http:// or https://)');
    }
    
    return errors;
}

function saveMachine(event) {
    event.preventDefault();
    
    // Validate form
    const errors = validateMachineForm();
    if (errors.length > 0) {
        const errorList = document.getElementById('errorList');
        errorList.innerHTML = errors.map(error => `<li>${error}</li>`).join('');
        document.getElementById('formErrors').classList.remove('hidden');
        return;
    }
    
    // Hide errors
    document.getElementById('formErrors').classList.add('hidden');
    
    // Show loading state
    const button = document.getElementById('saveMachineButton');
    const originalText = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Saving...';
    button.disabled = true;
    
    // Simulate API delay
    setTimeout(() => {
        let machines = getMachines();
        const id = document.getElementById('machineId').value;
        
        const newMachine = {
            name: document.getElementById('m-name').value.trim(),
            category: document.getElementById('m-category').value,
            price: parseFloat(document.getElementById('m-price').value),
            status: document.getElementById('m-status').value,
            image: document.getElementById('m-image').value.trim(),
            safetyNotes: document.getElementById('m-safetyNotes').value.trim(),
            specs: {},
            lastService: new Date().toISOString().split('T')[0],
            bookings: [],
        };
        
        if (id) {
            // EDIT existing machine
            const index = machines.findIndex(m => m.id === parseInt(id));
            if (index > -1) {
                machines[index] = { ...machines[index], ...newMachine, id: parseInt(id) };
                showNotification('Machine Updated', `${newMachine.name} has been updated successfully`, 'success');
            }
        } else {
            // ADD new machine
            const nextId = machines.length > 0 ? Math.max(...machines.map(m => m.id)) + 1 : 1;
            newMachine.id = nextId;
            machines.push(newMachine);
            showNotification('Machine Added', `${newMachine.name} has been added to inventory`, 'success');
        }
        
        setMachines(machines);
        closeMachineForm();
        
        // Reset button
        button.innerHTML = originalText;
        button.disabled = false;
        
        // Refresh inventory if on that tab
        if (currentTab === 'inventory') {
            renderInventory();
        }
        
        // Update dashboard
        renderDashboard();
    }, 800);
}

function editMachine(id) {
    openMachineForm(id);
}

function deleteMachine(id) {
    const machine = getMachines().find(m => m.id === id);
    if (!machine) return;
    
    if (confirm(`Are you sure you want to delete "${machine.name}"? This action cannot be undone.`)) {
        let machines = getMachines();
        machines = machines.filter(m => m.id !== id);
        setMachines(machines);
        
        renderInventory();
        showNotification('Machine Deleted', `${machine.name} has been removed from inventory`, 'warning');
    }
}

// ========== ORDER MANAGEMENT ==========
function renderOrders() {
    const orders = getOrders();
    const list = document.getElementById('orderList');
    const loading = document.getElementById('ordersLoading');
    const empty = document.getElementById('ordersEmpty');
    
    // Show loading
    list.innerHTML = '';
    loading.classList.remove('hidden');
    empty.classList.add('hidden');
    
    // Simulate loading delay
    setTimeout(() => {
        // Sort by newest first
        let sortedOrders = [...orders].sort((a, b) => b.orderId - a.orderId);
        
        // Check if empty
        if (sortedOrders.length === 0) {
            loading.classList.add('hidden');
            empty.classList.remove('hidden');
            return;
        }
        
        // Render table
        list.innerHTML = sortedOrders.map(o => {
            const paymentColor = getStatusColor(o.paymentStatus);
            const statusColor = getStatusColor(o.status);
            
            return `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="p-4 font-bold">
                        <div class="flex items-center">
                            <i class="fas fa-receipt text-industrial-blue mr-2"></i>
                            #${o.orderId}
                        </div>
                    </td>
                    <td class="p-4">${o.datePlaced}</td>
                    <td class="p-4 font-bold">$${o.totalAmount.toLocaleString()}</td>
                    <td class="p-4">
                        <button onclick="togglePaymentStatus(${o.orderId})" 
                            class="status-badge bg-${paymentColor}-100 text-${paymentColor} border-${paymentColor} hover:opacity-80 transition-opacity">
                            <i class="fas ${o.paymentStatus === 'Verified' ? 'fa-check-circle' : 'fa-clock'} mr-1"></i>
                            ${o.paymentStatus}
                        </button>
                    </td>
                    <td class="p-4">
                        <button onclick="toggleOrderStatus(${o.orderId})" 
                            class="status-badge bg-${statusColor}-100 text-${statusColor} border-${statusColor} hover:opacity-80 transition-opacity">
                            ${o.status}
                        </button>
                    </td>
                    <td class="p-4">
                        <div>
                            <p class="font-medium">${o.customer || 'Customer'}</p>
                            <p class="text-xs text-gray-500">${o.customerEmail || ''}</p>
                        </div>
                    </td>
                    <td class="p-4 text-center">
                        <div class="flex justify-center space-x-2">
                            <button onclick="openOrderDetails(${o.orderId})" 
                                class="px-3 py-1 text-sm bg-industrial-blue text-white rounded hover:bg-blue-700 transition-colors flex items-center">
                                <i class="fas fa-eye mr-1"></i> View
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
        
        loading.classList.add('hidden');
        
        // Apply any active filters
        filterOrderTable();
    }, 300);
}

function filterOrderTable() {
    const searchTerm = document.getElementById('orderSearch').value.toLowerCase();
    const statusFilter = document.getElementById('orderStatusFilter').value;
    const rows = document.querySelectorAll('#orderList tr');
    
    let visibleCount = 0;
    
    rows.forEach(row => {
        const orderId = row.querySelector('td:nth-child(1)').textContent.toLowerCase();
        const customer = row.querySelector('td:nth-child(6)').textContent.toLowerCase();
        const status = row.querySelector('td:nth-child(5) button').textContent;
        const matchesSearch = orderId.includes(searchTerm) || customer.includes(searchTerm);
        const matchesStatus = statusFilter === 'all' || status === statusFilter;
        
        if (matchesSearch && matchesStatus) {
            row.style.display = '';
            visibleCount++;
        } else {
            row.style.display = 'none';
        }
    });
    
    // Show/hide empty state
    const empty = document.getElementById('ordersEmpty');
    if (visibleCount === 0 && rows.length > 0) {
        empty.classList.remove('hidden');
        empty.innerHTML = `
            <i class="fas fa-search text-gray-300 text-4xl mb-4"></i>
            <h3 class="text-xl font-heading font-bold text-gray-500">No matching orders</h3>
            <p class="text-gray-400 mt-2">Try adjusting your search or filter</p>
        `;
    } else {
        empty.classList.add('hidden');
    }
}

function togglePaymentStatus(orderId) {
    let orders = getOrders();
    const index = orders.findIndex(o => o.orderId === orderId);
    
    if (index > -1) {
        orders[index].paymentStatus = orders[index].paymentStatus === 'Verified' ? 'Unverified' : 'Verified';
        setOrders(orders);
        renderOrders();
        renderDashboard();
        
        const status = orders[index].paymentStatus;
        showNotification(
            'Payment Status Updated', 
            `Order #${orderId} payment marked as ${status}`, 
            status === 'Verified' ? 'success' : 'warning'
        );
    }
}

function toggleOrderStatus(orderId) {
    let orders = getOrders();
    const index = orders.findIndex(o => o.orderId === orderId);
    
    if (index > -1) {
        const statusFlow = ['Pending', 'Processing', 'Completed', 'Cancelled'];
        const currentIndex = statusFlow.indexOf(orders[index].status);
        const nextIndex = (currentIndex + 1) % statusFlow.length;
        orders[index].status = statusFlow[nextIndex];
        
        setOrders(orders);
        renderOrders();
        renderDashboard();
        
        showNotification(
            'Order Status Updated', 
            `Order #${orderId} is now ${orders[index].status}`, 
            orders[index].status === 'Completed' ? 'success' : 'info'
        );
    }
}

function openOrderDetails(orderId) {
    const orders = getOrders();
    const order = orders.find(o => o.orderId === orderId);
    
    if (!order) return;
    
    document.getElementById('orderDetailId').textContent = orderId;
    
    let content = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-heading font-bold mb-3 text-lg">Order Information</h4>
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Order ID:</span>
                        <span class="font-bold">#${order.orderId}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Date Placed:</span>
                        <span>${order.datePlaced}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Total Amount:</span>
                        <span class="font-bold text-lg">$${order.totalAmount}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Payment Status:</span>
                        <span class="font-medium text-${getStatusColor(order.paymentStatus)}">${order.paymentStatus}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Order Status:</span>
                        <span class="font-medium text-${getStatusColor(order.status)}">${order.status}</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-heading font-bold mb-3 text-lg">Customer Information</h4>
                <div class="space-y-2">
                    <div>
                        <p class="text-gray-600">Company</p>
                        <p class="font-medium">${order.customer || 'Not specified'}</p>
                    </div>
                    <div>
                        <p class="text-gray-600">Email</p>
                        <p class="font-medium">${order.customerEmail || 'Not specified'}</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-6">
            <h4 class="font-heading font-bold mb-3 text-lg">Rented Items</h4>
            <div class="space-y-4">
                ${order.items.map(item => `
                    <div class="border border-industrial-border rounded-lg p-4 hover:bg-gray-50 transition-colors">
                        <div class="flex justify-between items-start">
                            <div>
                                <h5 class="font-bold text-lg">${item.name}</h5>
                                <div class="flex flex-wrap gap-2 mt-2">
                                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">${item.quantity} units</span>
                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${item.days} days</span>
                                    <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded">$${item.pricePerDay}/day</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold">$${item.total}</p>
                                <p class="text-sm text-gray-500">Subtotal</p>
                            </div>
                        </div>
                        <div class="mt-3 pt-3 border-t border-gray-200">
                            <p class="text-sm text-gray-600">
                                <i class="far fa-calendar-alt mr-1"></i>
                                Rental period: ${item.startDate} to ${item.endDate}
                            </p>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
        
        <div class="mt-6 pt-6 border-t border-gray-200 flex justify-end">
            <button onclick="closeOrderDetails()" class="px-4 py-2 bg-industrial-blue text-white rounded-lg hover:bg-blue-700 transition-colors">
                Close
            </button>
        </div>
    `;
    
    document.getElementById('orderDetailContent').innerHTML = content;
    document.getElementById('orderDetailsModal').classList.remove('hidden');
}

function closeOrderDetails() {
    document.getElementById('orderDetailsModal').classList.add('hidden');
}

// ========== INITIALIZATION ==========
document.addEventListener('DOMContentLoaded', function() {
    initializeOrders();
    checkAuthentication();
    
    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        // Escape key to close modals
        if (e.key === 'Escape') {
            closeMachineForm();
            closeOrderDetails();
        }
    });
});
</script>

</body>
</html>